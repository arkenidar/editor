<!-- example: Ractive-JS -->

<div id="ractive-container"></div>

<script id="template" type="text/ractive">
<div>Shopping Cart</div>
{{#if cart && cart.length > 0}}
{{#each cart : index}}
 <div>{{name}} - {{ price }} -
  <button on-click="@.splice('cart', index, 1)" > Remove </button>
 </div>
{{/each}}
<div>Total: {{ total }}</div>
{{else}}
<div>Your cart is empty.</div>
{{/if}}
<button on-click="@.push('cart', {name:'type1', price:11})" > add type 1 </button>
<button on-click="@.push('cart', {name:'type2', price:22})" > add type 2 </button>
<br> <a href="product-1.html" >product-1</a> <br> <a href="product-2.html" >product-2</a>
</script>

<script>
    function init() {

        //window.persistentData = {}; // Shared data object

        // [ { name:"name10" , price:10 } ]
        /*
        let initialPersistentData = { 'cart' : [ ] } ;
        window.persistentData = initialPersistentData ;
        
        if(typeof window.parent.persistentData !== "undefined")
         window.persistentData = window.parent.persistentData
        */

        var ractive = new Ractive({
            target: '#ractive-container',
            template: '#template',
            data: window.parent.persistentData,
            computed: {
                total() {
                    const cart = this.get('cart');
                    if (!cart) return 0;
                    return cart.reduce((total, item) => total + item.price, 0);
                }
            }
        });

        window.ractive = ractive;
    }

    function save() {
        //window.parent.persistentData = window.persistentData
    }

</script>